<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="theme-color" content="#e07a4e" />
    <link rel="manifest" href="manifest.json" />
    <link rel="apple-touch-icon" href="icon.svg" />
    <title>Catch a Cow - V1</title>
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <div class="app">
      <header class="topbar">
        <div class="title">
          <div class="logo">
            <svg class="logo-icon" viewBox="0 0 34 34" role="img" aria-label="Cow icon">
              <rect x="1" y="1" width="32" height="32" rx="9" fill="#f8f2e7" />
              <circle cx="17" cy="19" r="11" fill="#f7d36a" opacity="0.45" />
              <rect x="8" y="15" width="18" height="12" rx="3" fill="#8a5c3d" />
              <rect x="11" y="10" width="12" height="5" rx="2" fill="#f2e6c9" />
              <rect x="12" y="7" width="10" height="3" rx="1.5" fill="#efe4d3" />
              <circle cx="12" cy="19" r="1.6" fill="#3a2b1a" />
              <circle cx="22" cy="19" r="1.6" fill="#3a2b1a" />
              <path d="M13.5 22.5c1.5 1.2 5.5 1.2 7 0" stroke="#3a2b1a" stroke-width="1.2" fill="none" stroke-linecap="round" />
              <circle cx="11" cy="22.5" r="1.4" fill="rgba(255,150,150,0.6)" />
              <circle cx="23" cy="22.5" r="1.4" fill="rgba(255,150,150,0.6)" />
              <rect x="9" y="24.5" width="5" height="3.5" rx="1" fill="#3a2b1a" />
              <rect x="20" y="24.5" width="5" height="3.5" rx="1" fill="#3a2b1a" />
              <rect x="6.5" y="16" width="4" height="5" rx="2" fill="#b98b6a" />
              <rect x="23.5" y="16" width="4" height="5" rx="2" fill="#b98b6a" />
              <circle cx="14" cy="16.5" r="1.4" fill="#6c422a" opacity="0.7" />
              <circle cx="20.5" cy="17" r="1.1" fill="#6c422a" opacity="0.6" />
              <circle cx="26" cy="13" r="1.2" fill="#fff3c4" />
            </svg>
            <span>Catch a Cow</span>
          </div>
          <div class="subtitle">99 cows. Math wins the grassland.</div>
        </div>
        <div class="status">
          <div class="pill" id="connectionStatus">Offline</div>
          <div class="pill" id="timeOfDay">Day</div>
          <div class="pill" id="weather">Weather: Sun</div>
          <div class="pill" id="timer">Next shift: 60s</div>
          <div class="pill" id="seasonTimer">Season: 10:00</div>
        </div>
      </header>

      <main class="layout">
        <section class="panel" id="leftPanel">
          <h2>My Farm</h2>
          <div class="stat">
            <div class="label">Farm Name</div>
            <div class="value" id="farmNameValue">-</div>
          </div>
          <div class="stat">
            <div class="label">Cows (Season)</div>
            <div class="value" id="seasonCowCount">0</div>
          </div>
          <div class="stat">
            <div class="label">Cows (Total)</div>
            <div class="value" id="cowCount">0</div>
          </div>
          <div class="stat">
            <div class="label">Fence Strength</div>
            <div class="value" id="fenceStrength">1</div>
          </div>
          <div class="stat">
            <div class="label">Credits</div>
            <div class="value" id="credits">0</div>
          </div>
          <div class="stat">
            <div class="label">Locks</div>
            <div class="value" id="lockLevel">0</div>
          </div>
          <button id="upgradeFenceBtn" class="action">Upgrade Fence (Math)</button>
          <button id="upgradeLockBtn" class="action">Buy Lock (10 credits)</button>
          <button id="dissolveFarmBtn" class="action danger">Dissolve Farm</button>

          <div class="divider"></div>
          <h3 title="Season cows decide the winner.">Town Leaderboard (Season)</h3>
          <div id="leaderboard" class="leaderboard"></div>
        </section>

        <section class="world">
          <canvas id="worldCanvas" width="960" height="560"></canvas>
          <canvas id="minimap" width="180" height="120"></canvas>
          <div class="touch-controls" id="touchControls" aria-hidden="true">
            <button class="touch-btn" data-dir="up">▲</button>
            <div class="touch-row">
              <button class="touch-btn" data-dir="left">◀</button>
              <button class="touch-btn" data-dir="down">▼</button>
              <button class="touch-btn" data-dir="right">▶</button>
            </div>
          </div>
          <div class="hud">
          <div class="hint">Move: WASD or Arrow Keys | Scan: auto when close | Enter: Chat (nearby only)</div>
          </div>
          <div class="chat-input-container" id="chatContainer" style="display: none;">
            <input type="text" id="chatInput" maxlength="100" placeholder="Type a message..." />
            <button id="chatSendBtn" class="action">Send</button>
          </div>
        </section>

        <section class="panel" id="rightPanel">
          <h2>Target Cow</h2>
          <div id="cowProfile" class="profile">No cow nearby. Explore the grassland.</div>
          <div class="actions">
            <button id="ropeBtn" class="action" disabled>Build Rope</button>
            <button id="netBtn" class="action" disabled>Build Net</button>
          </div>

          <div class="divider"></div>
          <h3>Math Workshop</h3>
          <div id="puzzleBox" class="puzzle">
            Solve math to build tools, fences, and defenses.
          </div>
        </section>
      </main>

      <section class="log">
        <div class="log-title">Town Feed</div>
        <div id="logFeed" class="log-feed"></div>
      </section>
    </div>

    <div class="modal" id="startModal">
      <div class="modal-card">
        <h2>Start Your Farm</h2>
        <p>10-minute seasons. Only cows caught this season count toward the winner.</p>
        <p>Your farm and total cows persist between seasons.</p>
        <div class="rule-anim" aria-hidden="true">
          <div class="rule-stage">
            <svg class="rule-cow" viewBox="0 0 60 46">
              <circle cx="30" cy="25" r="18" fill="#f7d36a" opacity="0.5" />
              <rect x="16" y="18" width="28" height="18" rx="5" fill="#8a5c3d" />
              <rect x="22" y="10" width="16" height="8" rx="3" fill="#f2e6c9" />
              <circle cx="22" cy="25" r="2" fill="#3a2b1a" />
              <circle cx="38" cy="25" r="2" fill="#3a2b1a" />
              <path d="M24 29c3 2.4 9 2.4 12 0" stroke="#3a2b1a" stroke-width="1.6" fill="none" stroke-linecap="round" />
              <circle cx="21" cy="30" r="2" fill="rgba(255,150,150,0.6)" />
              <circle cx="39" cy="30" r="2" fill="rgba(255,150,150,0.6)" />
              <rect x="18" y="34" width="8" height="6" rx="2" fill="#3a2b1a" />
              <rect x="34" y="34" width="8" height="6" rx="2" fill="#3a2b1a" />
            </svg>
            <div class="rule-coin">+1</div>
            <div class="rule-coin gold">+2</div>
            <div class="rule-timer">10:00</div>
          </div>
          <div class="rule-caption cap-1">Catch cows → season score</div>
          <div class="rule-caption cap-2">Golden cow = +2 season cows</div>
          <div class="rule-caption cap-3">Season winner every 10 min</div>
        </div>
        <input id="farmNameInput" type="text" maxlength="20" placeholder="e.g., Meadowlight Farm" />
        <div class="color-row">
          <label for="farmColorInput">Choose your avatar color</label>
          <input id="farmColorInput" type="color" value="#2f2b23" />
        </div>
        <button id="startBtn" class="action">Start Game</button>
        <div class="note">99 cows exist in the world. Catch the most to be richest in town.</div>
      </div>
    </div>

    <script src="data.js"></script>
    <script src="app.js"></script>
  </body>
</html>
